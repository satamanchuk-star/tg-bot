FROM python:3.12-slim

ARG BUILD_VERSION=dev
ENV BUILD_VERSION=$BUILD_VERSION

ENV FORUM_CHAT_ID=-1002127934225
ENV ADMIN_LOG_CHAT_ID=-1003697662870
ENV DATABASE_URL=sqlite+aiosqlite:///app/data/bot.db
ENV TIMEZONE=Europe/Moscow
ENV TOPIC_RULES=93144
ENV TOPIC_IMPORTANT=669
ENV TOPIC_BUILDINGS_41_42=14733
ENV TOPIC_BUILDING_2=14726
ENV TOPIC_BUILDING_3=14725
ENV TOPIC_COMPLAINTS=2982
ENV TOPIC_RIDES=3
ENV TOPIC_SMOKE=410
ENV TOPIC_PETS=7523
ENV TOPIC_REPAIR=1763
ENV TOPIC_REALTY=13074
ENV TOPIC_PARENTS=8
ENV TOPIC_ADS=99
ENV TOPIC_GAMES=4747
ENV TOPIC_GATE=77848
ENV TOPIC_SERVICES=3240
ENV TOPIC_UK=5
ENV TOPIC_NEIGHBORS=164
ENV TOPIC_MARKET=7
ENV TOPIC_DUPLEX=18378

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY app/ ./app/

RUN mkdir -p /app/data

VOLUME ["/app/data"]

# BOT_TOKEN передаётся при запуске: docker run -e BOT_TOKEN=xxx
CMD ["python", "-m", "app.main"]
